<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Wenying Deng" />

<meta name="date" content="2020-08-17" />

<title>Using the CVEK R package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using the CVEK R package</h1>
<h4 class="author">Wenying Deng</h4>
<h4 class="date">2020-08-17</h4>



<div id="short-description" class="section level2">
<h2>Short Description</h2>
<p>Using a library of base kernels, <strong>CVEK</strong> learns a proper generating function from data by directly minimizing the ensemble model’s error, and tests whether the data is generated by the RKHS under the null hypothesis.</p>
<p>Download the package from CRAN or <a href="https://github.com/IrisTeng/CVEK">GitHub</a> and then install and load it.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;IrisTeng/CVEK-1&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt;   </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">   checking <span class="cf">for</span> file ‘<span class="op">/</span>private<span class="op">/</span>var<span class="op">/</span>folders<span class="op">/</span>9t<span class="op">/</span>y8yg2z6s6n37yhh90h8rwlkm0000gn<span class="op">/</span>T<span class="op">/</span>RtmpyUp2Co<span class="op">/</span>remotes12630787a2baf<span class="op">/</span>IrisTeng<span class="op">-</span>CVEK<span class="dv">-1</span><span class="fl">-3e03</span>a86<span class="op">/</span>DESCRIPTION’ ...</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb1-6" data-line-number="6">✔  checking <span class="cf">for</span> file ‘<span class="op">/</span>private<span class="op">/</span>var<span class="op">/</span>folders<span class="op">/</span>9t<span class="op">/</span>y8yg2z6s6n37yhh90h8rwlkm0000gn<span class="op">/</span>T<span class="op">/</span>RtmpyUp2Co<span class="op">/</span>remotes12630787a2baf<span class="op">/</span>IrisTeng<span class="op">-</span>CVEK<span class="dv">-1</span><span class="fl">-3e03</span>a86<span class="op">/</span>DESCRIPTION’</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb1-9" data-line-number="9">─  preparing ‘CVEK’<span class="op">:</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="st">   </span>checking DESCRIPTION meta<span class="op">-</span>information ...</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb1-14" data-line-number="14">─  checking DESCRIPTION meta<span class="op">-</span>information ...It is recommended to use ‘given’ instead of ‘middle’.</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb1-17" data-line-number="17">    OK</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  </a>
<a class="sourceLine" id="cb1-20" data-line-number="20">   It is recommended to use ‘given’ instead of ‘middle’.</a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">  </a>
<a class="sourceLine" id="cb1-23" data-line-number="23">─  checking <span class="cf">for</span> LF line<span class="op">-</span>endings <span class="cf">in</span> source and make files and shell scripts</a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">  </a>
<a class="sourceLine" id="cb1-26" data-line-number="26">─  checking <span class="cf">for</span> empty or unneeded directories</a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28">  </a>
<a class="sourceLine" id="cb1-29" data-line-number="29">─  building ‘CVEK_<span class="fl">0.1-0.</span>tar.gz’</a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31">  </a>
<a class="sourceLine" id="cb1-32" data-line-number="32">   </a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="kw">library</span>(CVEK)</a></code></pre></div>
</div>
<div id="test-functions" class="section level2">
<h2>Test Functions</h2>
<div id="estimation" class="section level3">
<h3>Estimation</h3>
<p>We can apply <em>estimation</em> function to conduct Gaussian process regression.</p>
<p><em>estimation</em> function has seven returns with seven parameters.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">estimation</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; function (Y, X, K_list = NULL, mode = &quot;loocv&quot;, strategy = &quot;stack&quot;, </span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;     beta_exp = 1, lambda = exp(seq(-10, 5)), ...) </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;     n &lt;- length(Y)</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;     if (sum(X[, 1] == 1) != n) {</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;         X &lt;- cbind(matrix(1, nrow = n, ncol = 1), X)</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;     kern_size &lt;- length(K_list)</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;     if (kern_size == 0) {</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;         base_est &lt;- NULL</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;         K_ens &lt;- NULL</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt;         lambda_ens &lt;- tuning(Y, X, K_ens, mode, lambda)</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt;         ens_est &lt;- estimate_ridge(Y = Y, X = X, K = K_ens, lambda = lambda_ens, </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt;             ...)</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt;         u_weight &lt;- 1</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt;         kern_term_effect &lt;- NULL</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt;         base_est &lt;- estimate_base(Y, X, K_list, mode, lambda, </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt;             ...)</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt;         P_K_hat &lt;- base_est$P_K_hat</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt;         error_mat &lt;- base_est$error_mat</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt;         ens_res &lt;- ensemble(strategy, beta_exp, error_mat, P_K_hat)</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt;         K_ens &lt;- ensemble_kernel_matrix(ens_res$A_est)</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt;         K_ens &lt;- list(K_ens)</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt;         lambda_ens &lt;- tuning(Y, X, K_ens, mode, lambda)</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt;         ens_est &lt;- estimate_ridge(Y = Y, X = X, K = K_ens, lambda = lambda_ens, </span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt;             ...)</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt;         u_weight &lt;- ens_res$u_hat</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt;         kern_term_effect &lt;- 0</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt;         for (k in seq(kern_size)) {</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">#&gt;             kern_term_effect &lt;- kern_term_effect + u_weight[k] * </span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co">#&gt;                 base_est$kern_term_list[[k]]</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="co">#&gt;         }</span></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"><span class="co">#&gt;     list(lambda = lambda_ens, beta = ens_est$beta, alpha = ens_est$alpha, </span></a>
<a class="sourceLine" id="cb2-38" data-line-number="38"><span class="co">#&gt;         K = K_ens[[1]], u_hat = u_weight, kern_term_effect = kern_term_effect, </span></a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="co">#&gt;         base_est = base_est)</span></a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="co">#&gt; &lt;bytecode: 0x7f96a23c7830&gt;</span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42"><span class="co">#&gt; &lt;environment: namespace:CVEK&gt;</span></a></code></pre></div>
<p>Note that:</p>
<ul>
<li>The first two parameters <em>Y</em> and <em>X</em> are mandatory for management.</li>
<li><em>estimation</em> is the core function for estimation, which is nested in the main function <em>cvek</em>.</li>
<li>If the third parameter <em>K_list</em> is not given, the model will conduct linear regression.</li>
<li>For the last four parameters, users can substitute alternatives for the default ones.</li>
</ul>
<p>For example, we have a training dataset with <span class="math inline">\(n=100\)</span>, and no alternative effect,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">0726</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">150</span> <span class="co"># including training and test</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">d &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>d),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dt">ncol =</span> d,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="ot">NULL</span>, <span class="kw">paste0</span>(<span class="st">&quot;x&quot;</span>, <span class="dv">1</span><span class="op">:</span>d))</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">))</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">beta_true &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.41</span>, <span class="fl">2.37</span>)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">data<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">cbind</span>(<span class="dv">1</span>, data[, <span class="kw">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>)])) <span class="op">%*%</span><span class="st"> </span>beta_true</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">data_train &lt;-<span class="st"> </span>data[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, ]</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">data_test &lt;-<span class="st"> </span>data[<span class="dv">101</span><span class="op">:</span><span class="dv">150</span>, ]</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">x3</th>
<th align="right">x4</th>
<th align="right">x5</th>
<th align="right">x6</th>
<th align="right">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.3540220</td>
<td align="right">-1.6052695</td>
<td align="right">-1.0901996</td>
<td align="right">-0.4972348</td>
<td align="right">-1.0261123</td>
<td align="right">-0.5442417</td>
<td align="right">-2.9496378</td>
</tr>
<tr class="even">
<td align="right">-1.3521966</td>
<td align="right">1.0939911</td>
<td align="right">0.1082880</td>
<td align="right">0.1047508</td>
<td align="right">-0.6245780</td>
<td align="right">0.7821868</td>
<td align="right">3.0383584</td>
</tr>
<tr class="odd">
<td align="right">0.5276426</td>
<td align="right">-0.5886939</td>
<td align="right">0.9414443</td>
<td align="right">2.0359570</td>
<td align="right">0.7301499</td>
<td align="right">-0.8777976</td>
<td align="right">-0.1788710</td>
</tr>
<tr class="even">
<td align="right">-1.0576862</td>
<td align="right">-0.8509214</td>
<td align="right">0.2522741</td>
<td align="right">-1.3882738</td>
<td align="right">-1.5012632</td>
<td align="right">-0.3587080</td>
<td align="right">-1.4503349</td>
</tr>
<tr class="odd">
<td align="right">0.9926991</td>
<td align="right">0.6003666</td>
<td align="right">0.4721120</td>
<td align="right">-0.5778911</td>
<td align="right">1.3460197</td>
<td align="right">1.3795510</td>
<td align="right">2.8298755</td>
</tr>
<tr class="even">
<td align="right">-1.5824189</td>
<td align="right">-2.8136014</td>
<td align="right">-1.8151537</td>
<td align="right">0.3812716</td>
<td align="right">-0.2053037</td>
<td align="right">0.0872907</td>
<td align="right">-6.3170270</td>
</tr>
<tr class="odd">
<td align="right">-1.1826914</td>
<td align="right">1.0852837</td>
<td align="right">-0.7809943</td>
<td align="right">-1.1763517</td>
<td align="right">1.4253650</td>
<td align="right">1.1458677</td>
<td align="right">3.0872189</td>
</tr>
<tr class="even">
<td align="right">-0.4402250</td>
<td align="right">-0.0804082</td>
<td align="right">-0.4495142</td>
<td align="right">0.3865038</td>
<td align="right">-2.4762648</td>
<td align="right">-0.8759821</td>
<td align="right">0.6289403</td>
</tr>
<tr class="odd">
<td align="right">1.3854621</td>
<td align="right">2.3617840</td>
<td align="right">-1.4585682</td>
<td align="right">-0.8577124</td>
<td align="right">-0.5366619</td>
<td align="right">-1.2829528</td>
<td align="right">7.1654676</td>
</tr>
<tr class="even">
<td align="right">1.1231911</td>
<td align="right">0.1759271</td>
<td align="right">0.6092619</td>
<td align="right">-2.2236030</td>
<td align="right">-0.5253511</td>
<td align="right">0.4125109</td>
<td align="right">1.8774556</td>
</tr>
</tbody>
</table>
<p>We want our kernel library to contain three kernels: <span class="math inline">\(&quot;linear&quot;\)</span>, <span class="math inline">\(&quot;polynomial&quot;\)</span> with <span class="math inline">\(p=2\)</span>, and <span class="math inline">\(&quot;rbf&quot;\)</span> with <span class="math inline">\(l=1.5, p=3\)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">kern_par &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">method =</span> <span class="kw">c</span>(<span class="st">&quot;linear&quot;</span>, <span class="st">&quot;polynomial&quot;</span>, <span class="st">&quot;rbf&quot;</span>), </a>
<a class="sourceLine" id="cb4-2" data-line-number="2">                         <span class="dt">l =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>), <span class="dt">p =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="co"># define kernel library</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">kern_func_list &lt;-<span class="st"> </span><span class="kw">define_library</span>(kern_par)</a></code></pre></div>
<p>And the null model is <span class="math inline">\(y \sim x1 + x2 + k(x3, x4) + k(x5, x6)\)</span>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">formula &lt;-<span class="st"> </span>y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span><span class="kw">k</span>(x3, x4) <span class="op">+</span><span class="st"> </span><span class="kw">k</span>(x5, x6)</a></code></pre></div>
<p>With all these parameters specified, we can conducts Gaussian process regression,</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">est_res &lt;-<span class="st"> </span><span class="kw">cvek</span>(formula, <span class="dt">kern_func_list =</span> kern_func_list, <span class="dt">data =</span> data_train)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># est_res$lambda</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co"># est_res$beta</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># est_res$u_hat</span></a></code></pre></div>
</div>
<div id="testing" class="section level3">
<h3>Testing</h3>
<p>Then, here comes the testing procedure.</p>
<p><em>cvek_test</em> function has one return with several parameters.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">cvek_test</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; function (est_res, formula_test, kern_func_list, data, test = &quot;boot&quot;, </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;     alt_kernel_type = &quot;ensemble&quot;, B = 100, verbose = FALSE) </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;     alt_kernel_type &lt;- match.arg(alt_kernel_type, c(&quot;linear&quot;, </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;         &quot;ensemble&quot;))</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;     if (alt_kernel_type == &quot;linear&quot;) {</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;         lnr_kern_func &lt;- generate_kernel(method = &quot;linear&quot;)</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;         alt_kern_func_list &lt;- list(lnr_kern_func)</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;     else if (alt_kernel_type == &quot;ensemble&quot;) {</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;         alt_kern_func_list &lt;- kern_func_list</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;     test_matrices &lt;- parse_cvek_formula(formula_test, kern_func_list = alt_kern_func_list, </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt;         data = data, verbose = verbose)</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt;     linear_terms &lt;- setdiff(colnames(test_matrices$X), &quot;(Intercept)&quot;)</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt;     if (length(linear_terms) &gt; 0) {</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt;         stop(gettextf(&quot;'formula_test' should contain only kernel terms. Linear terms found: %s&quot;, </span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt;             paste0(linear_terms, collapse = &quot;, &quot;)))</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt;     if (alt_kernel_type == &quot;linear&quot;) {</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt;         K_std_list &lt;- lapply(test_matrices$K[[1]], function(K) K/sum(diag(K)))</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt;         K_int &lt;- Reduce(&quot;+&quot;, K_std_list)</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt;     else {</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt;         u_weight &lt;- est_res$u_hat</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt;         K_int &lt;- 0</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt;         for (k in seq(length(kern_func_list))) {</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt;             K_std_list &lt;- lapply(test_matrices$K[[k]], function(K) K/sum(diag(K)))</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt;             K_temp &lt;- Reduce(&quot;+&quot;, K_std_list)</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt;             K_int &lt;- K_int + u_weight[k] * K_temp</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt;         }</span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt;     model_matrices &lt;- est_res$model_matrices</span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt;     y_fixed &lt;- model_matrices$X %*% est_res$beta</span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt;     sigma2_hat &lt;- estimate_sigma2(Y = model_matrices$y, X = model_matrices$X, </span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt;         lambda_hat = est_res$lambda, y_fixed_hat = y_fixed, alpha_hat = est_res$alpha, </span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt;         K_hat = est_res$K)</span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#&gt;     tau_hat &lt;- sigma2_hat/est_res$lambda</span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"><span class="co">#&gt;     func_name &lt;- paste0(&quot;test_&quot;, test)</span></a>
<a class="sourceLine" id="cb7-41" data-line-number="41"><span class="co">#&gt;     do.call(func_name, list(Y = model_matrices$y, X = model_matrices$X, </span></a>
<a class="sourceLine" id="cb7-42" data-line-number="42"><span class="co">#&gt;         y_fixed = y_fixed, alpha0 = est_res$alpha, K_ens = est_res$K, </span></a>
<a class="sourceLine" id="cb7-43" data-line-number="43"><span class="co">#&gt;         K_int = K_int, sigma2_hat = sigma2_hat, tau_hat = tau_hat, </span></a>
<a class="sourceLine" id="cb7-44" data-line-number="44"><span class="co">#&gt;         B = B))</span></a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb7-46" data-line-number="46"><span class="co">#&gt; &lt;bytecode: 0x7f96a029a378&gt;</span></a>
<a class="sourceLine" id="cb7-47" data-line-number="47"><span class="co">#&gt; &lt;environment: namespace:CVEK&gt;</span></a></code></pre></div>
<p>Note that we can use the same function <em>cvek</em> as estimation to perform hypothesis testing, but we need to provide <span class="math inline">\(formula\_test\)</span>, which is the user-supplied formula indicating the alternative effect to test.</p>
<p>Now, we want to conduct score test with <span class="math inline">\(test=&quot;boot&quot;\)</span> and <span class="math inline">\(B=200\)</span> since the sample n is small (<span class="math inline">\(n=100\)</span>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">formula_test &lt;-<span class="st"> </span>y <span class="op">~</span><span class="st"> </span><span class="kw">k</span>(x1)<span class="op">:</span><span class="kw">k</span>(x4, x5)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">pvalue &lt;-<span class="st"> </span><span class="kw">cvek</span>(formula, <span class="dt">kern_func_list =</span> kern_func_list, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">               <span class="dt">data =</span> data_train, <span class="dt">formula_test =</span> formula_test,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">               <span class="dt">mode =</span> <span class="st">&quot;loocv&quot;</span>, <span class="dt">strategy =</span> <span class="st">&quot;stack&quot;</span>,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">               <span class="dt">beta_exp =</span> <span class="dv">1</span>, <span class="dt">lambda =</span> <span class="kw">exp</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">               <span class="dt">test =</span> <span class="st">&quot;boot&quot;</span>, <span class="dt">alt_kernel_type =</span> <span class="st">&quot;ensemble&quot;</span>,</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">               <span class="dt">B =</span> <span class="dv">200</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)<span class="op">$</span>pvalue</a></code></pre></div>
</div>
<div id="prediction" class="section level3">
<h3>Prediction</h3>
<p>Finally, we can prediction new outcomes based on estimation result.</p>
<p><em>predict.cvek</em> function has one return with two parameters.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">predict.cvek</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; function (object, newdata, ...) </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt;     model_matrices &lt;- object$model_matrices</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;     kern_func_list &lt;- object$kern_func_list</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt;     new_matrices &lt;- parse_cvek_formula(object$formula, kern_func_list, </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt;         data = object$data, data_new = newdata)</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt;     X &lt;- new_matrices$X</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;     A &lt;- 0</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;     Xmat &lt;- ginv(t(model_matrices$X) %*% model_matrices$X) %*% </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt;         t(model_matrices$X)</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt;     H &lt;- model_matrices$X %*% Xmat</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt;     H_star &lt;- X %*% Xmat</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;     n &lt;- length(object$alpha)</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt;     P_K_star &lt;- list()</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt;     P_X_star &lt;- list()</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt;     y_pred &lt;- 0</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt;     for (k in seq(length(kern_func_list))) {</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt;         B_temp &lt;- 0</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt;         for (d in seq(length(new_matrices$K[[k]]))) {</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt;             S_d_star &lt;- new_matrices$K[[k]][[d]] %*% ginv(model_matrices$K[[k]][[d]] + </span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt;                 object$base_est$lambda_list[[k]] * diag(n))</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt;             B_temp &lt;- B_temp + S_d_star %*% (diag(n) + object$base_est$A_proc_list[[k]][[d]])</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt;         }</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt;         B_star &lt;- B_temp %*% (diag(n) - object$base_est$P_K_hat[[k]])</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">#&gt;         P_K &lt;- ginv(diag(n) - object$base_est$P_K_hat[[k]] %*% </span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#&gt;             H) %*% object$base_est$P_K_hat[[k]] %*% (diag(n) - </span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">#&gt;             H)</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#&gt;         P_K_star[[k]] &lt;- B_star %*% (diag(n) - H + H %*% object$base_est$P_K_hat[[k]])</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">#&gt;         P_X_star[[k]] &lt;- H_star %*% (diag(n) - P_K)</span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">#&gt;         y_pred &lt;- y_pred + object$u_hat[k] * (P_K_star[[k]] + </span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#&gt;             P_X_star[[k]]) %*% object$data$y</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#&gt;     }</span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co">#&gt;     y_pred</span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co">#&gt; &lt;bytecode: 0x7f96a036abf0&gt;</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co">#&gt; &lt;environment: namespace:CVEK&gt;</span></a></code></pre></div>
<p>Now that we have the estimation result <em>est_res</em>, we can predict new outcomes.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">y_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(est_res, data_test[, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>])</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">data_test_pred &lt;-<span class="st"> </span><span class="kw">cbind</span>(data_test, y_pred)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">x3</th>
<th align="right">x4</th>
<th align="right">x5</th>
<th align="right">x6</th>
<th align="right">y</th>
<th align="right">y_pred</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>101</td>
<td align="right">0.8838175</td>
<td align="right">-1.4394967</td>
<td align="right">-0.8253074</td>
<td align="right">0.4324971</td>
<td align="right">0.9195254</td>
<td align="right">-0.3432094</td>
<td align="right">-2.0492421</td>
<td align="right">-1.8768657</td>
</tr>
<tr class="even">
<td>102</td>
<td align="right">-0.7374137</td>
<td align="right">-0.5554419</td>
<td align="right">0.8185338</td>
<td align="right">0.8102164</td>
<td align="right">0.3980497</td>
<td align="right">-0.9216215</td>
<td align="right">-0.6187369</td>
<td align="right">-0.4466793</td>
</tr>
<tr class="odd">
<td>103</td>
<td align="right">-1.0640729</td>
<td align="right">0.3117576</td>
<td align="right">1.4992974</td>
<td align="right">-0.1593042</td>
<td align="right">-0.1866308</td>
<td align="right">0.8366369</td>
<td align="right">1.3025956</td>
<td align="right">1.4809663</td>
</tr>
<tr class="even">
<td>104</td>
<td align="right">-0.2485406</td>
<td align="right">-0.4337847</td>
<td align="right">0.7700828</td>
<td align="right">-1.0506973</td>
<td align="right">1.2428282</td>
<td align="right">-2.3714296</td>
<td align="right">-0.1299713</td>
<td align="right">0.0533751</td>
</tr>
<tr class="odd">
<td>105</td>
<td align="right">-1.0785118</td>
<td align="right">0.7700415</td>
<td align="right">1.3938194</td>
<td align="right">0.9366023</td>
<td align="right">1.0397214</td>
<td align="right">-0.0422093</td>
<td align="right">2.3828085</td>
<td align="right">2.5585133</td>
</tr>
<tr class="even">
<td>106</td>
<td align="right">0.7641049</td>
<td align="right">-1.6609427</td>
<td align="right">1.8352057</td>
<td align="right">0.0899934</td>
<td align="right">-0.5037753</td>
<td align="right">-0.9547138</td>
<td align="right">-2.6231512</td>
<td align="right">-2.4435002</td>
</tr>
<tr class="odd">
<td>107</td>
<td align="right">0.7890356</td>
<td align="right">-0.3845567</td>
<td align="right">-0.0228127</td>
<td align="right">-1.5571770</td>
<td align="right">0.8959454</td>
<td align="right">-1.1926713</td>
<td align="right">0.4121051</td>
<td align="right">0.5897265</td>
</tr>
<tr class="even">
<td>108</td>
<td align="right">1.4193372</td>
<td align="right">-0.2090495</td>
<td align="right">1.8302570</td>
<td align="right">1.1011365</td>
<td align="right">0.3983724</td>
<td align="right">-0.2003151</td>
<td align="right">1.0864809</td>
<td align="right">1.2662277</td>
</tr>
<tr class="odd">
<td>109</td>
<td align="right">0.9713871</td>
<td align="right">1.7638705</td>
<td align="right">-1.8423892</td>
<td align="right">-2.0771168</td>
<td align="right">-0.7802915</td>
<td align="right">-0.4356981</td>
<td align="right">5.5786417</td>
<td align="right">5.7737493</td>
</tr>
<tr class="even">
<td>110</td>
<td align="right">0.1611789</td>
<td align="right">1.3241043</td>
<td align="right">0.1557150</td>
<td align="right">1.3100954</td>
<td align="right">-0.0596435</td>
<td align="right">1.8815622</td>
<td align="right">4.2042105</td>
<td align="right">4.3843634</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ol style="list-style-type: decimal">
<li>Jeremiah Zhe Liu and Brent Coull. Robust Hypothesis Test for Nonlinear Effect with Gaussian Processes. October 2017.</li>
<li>Xiang Zhan, Anna Plantinga, Ni Zhao, and Michael C. Wu. A fast small-sample kernel inde- pendence test for microbiome community-level association analysis. December 2017.</li>
<li>Arnak S. Dalalyan and Alexandre B. Tsybakov. Aggregation by Exponential Weighting and Sharp Oracle Inequalities. In Learning Theory, Lecture Notes in Computer Science, pages 97– 111. Springer, Berlin, Heidelberg, June 2007.</li>
<li>Arnab Maity and Xihong Lin. Powerful tests for detecting a gene effect in the presence of possible gene-gene interactions using garrote kernel machines. December 2011.</li>
<li>The MIT Press. Gaussian Processes for Machine Learning, 2006.</li>
<li>Xihong Lin. Variance component testing in generalised linear models with random effects. June 1997.</li>
<li>Philip S. Boonstra, Bhramar Mukherjee, and Jeremy M. G. Taylor. A Small-Sample Choice of the Tuning Parameter in Ridge Regression. July 2015.</li>
<li>Trevor Hastie, Robert Tibshirani, and Jerome Friedman. The Elements of Statistical Learning: Data Mining, Inference, and Prediction, Second Edition. Springer Series in Statistics. Springer- Verlag, New York, 2 edition, 2009.</li>
<li>Hirotogu Akaike. Information Theory and an Extension of the Maximum Likelihood Princi- ple. In Selected Papers of Hirotugu Akaike, Springer Series in Statistics, pages 199–213. Springer, New York, NY, 1998.</li>
<li>Clifford M. Hurvich and Chih-Ling Tsai. Regression and time series model selection in small samples. June 1989.</li>
<li>Hurvich Clifford M., Simonoff Jeffrey S., and Tsai Chih-Ling. Smoothing parameter selection in nonparametric regression using an improved Akaike information criterion. January 2002.</li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
